<!-- Variation 1 -->
<th:block th:fragment="product-price-variation-1">
    <!-- 
        th:comment 
        This variation keeps a two-column layout if we have chart data (new or used), 
        otherwise uses full width for the message block. 
        Uses standard Bootstrap classes only. 
    -->
    <section class="container my-5" id="markerPrices">
        <th:block th:with="
            hasNewPriceHistory=${product.price.newPricehistory != null and !#lists.isEmpty(product.price.newPricehistory)},
            hasOccasionPriceHistory=${product.price.occasionPricehistory != null and !#lists.isEmpty(product.price.occasionPricehistory)},
            colSize=${hasNewPriceHistory and hasOccasionPriceHistory ? 6 : 12}
        ">
            <div class="row text-center justify-content-center">
                <div class="col-md-8 mb-4">
                    <h2 class="fw-bold">Une bonne affaire&nbsp;?</h2>
                </div>
            </div>

            <div class="card shadow border-secondary text-center mx-auto">
                <div class="row align-items-center">
                    <!-- Left column: Price messages -->
                    <div th:attr="class='col-md-' + (${hasNewPriceHistory or hasOccasionPriceHistory} ? 4 : 12)">
                        <div class="m-4">
                            <!-- Price Variation Alert -->
                            <div th:if="${newTrend.trend == 0}" class="alert alert-info text-center" role="alert">
                                üò∂‚Äçüå´Ô∏è Le prix neuf est stable depuis 
                                <span th:text="${newTrend.formatedDuration()}"></span>
                            </div>
                            <div th:if="${newTrend.trend == 1}" class="alert alert-warning text-center" role="alert">
                                üßê Le prix neuf a augment√© de 
                                <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                depuis le dernier pointage 
                                (<span th:text="${newTrend.formatedDuration()}"></span>)
                            </div>
                            <div th:if="${newTrend.trend == -1}" class="alert alert-success text-center" role="alert">
                                Le prix neuf a baiss√© de 
                                <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b> 
                                depuis le dernier relev√© 
                                (<span th:text="${newTrend.formatedDuration()}"></span>) üòä
                            </div>
                        </div>

                        <div class="card shadow mx-4 mb-4">
                            <div class="card-body text-center text-md-start">
                                <div class="row align-items-center">
                                    <!-- Historical Price -->
                                    <div th:if="${newTrend.historicalLowestPrice != 0}" class="col-md-12">
                                        <span class="d-block mb-2 fw-bold">
                                            Prix le plus bas historique !
                                        </span>
                                        <p class="mb-0">
                                            Nous n'avons jamais relev√© de prix aussi bas pour le
                                            <span th:text="${product.brandAndModel()}"></span>.
                                        </p>
                                    </div>
                                    <div th:unless="${newTrend.historicalLowestPrice != 0}" class="col-md-8">
                                        <h3 class="mb-3">√âcart de prix historique</h3>
                                        <p class="mb-0">
                                            √âcart calcul√© avec le prix le plus bas relev√© 
                                            (<span th:text="${newTrend.historicalLowestPrice}"></span>‚Ç¨)
                                            jamais relev√© pour 
                                            <span th:text="${product.brandAndModel()}"></span>.
                                        </p>
                                    </div>
                                    <div th:unless="${newTrend.historicalLowestPrice != 0}" class="col-12 col-md-4 mt-4 mt-md-0 text-md-end">
                                        <span class="d-block my-3">
                                            <span class="h3 fw-bold" 
                                                  th:text="${#numbers.formatDecimal(newTrend.historicalVariation ?: 0, 0, 1)}">0</span>
                                            <span class="align-baseline">‚Ç¨</span>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Button to "Meilleur prix" -->
                        <div class="mx-4 mb-4">
                            <a href="#markerEcoscore" class="btn btn-primary w-100" aria-label="Voir le meilleur prix">
                                <span class="me-1">
                                    <i class="fas fa-euro"></i>
                                </span>
                                Meilleur prix
                            </a>
                        </div>
                    </div>

                    <!-- Right column: Charts -->
                    <div class="col-md-8 mt-4 mt-md-0" th:if="${hasNewPriceHistory or hasOccasionPriceHistory}">
                        <div class="row">
                            <!-- New Price Chart -->
                            <div th:if="${hasNewPriceHistory}" th:attr="class='col-md-' + ${colSize}">
                                <canvas class="mt-4" id="newPriceChart" aria-label="Graphique prix neuf"></canvas>
                                <div class="text-center">
                                    <div class="btn-group my-3" role="group" aria-label="S√©lection de la p√©riode prix neuf">
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-15days" aria-label="15 jours">15 jours</button>
                                        <button type="button" class="btn btn-secondary active period-btn" id="btn-new-3months" aria-label="3 mois">3 mois</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-6months" aria-label="6 mois">6 mois</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-max" aria-label="Max">Max</button>
                                    </div>
                                </div>
                            </div>

                            <!-- Used Price Chart -->
                            <div th:if="${hasOccasionPriceHistory}" th:attr="class='col-md-' + ${colSize}">
                                <canvas class="mt-4" id="usedPriceChart" aria-label="Graphique prix occasion"></canvas>
                                <div class="text-center">
                                    <div class="btn-group my-3" role="group" aria-label="S√©lection de la p√©riode prix occasion">
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-15days">15 jours</button>
                                        <button type="button" class="btn btn-secondary active period-btn" id="btn-used-3months">3 mois</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-6months">6 mois</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-max">Max</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </th:block>
    </section>
</th:block>



<th:block th:fragment="product-price-variation-2">
    <!-- 
        th:comment
        This variation puts the charts on top (full width) and the price messages below them. 
        Also uses standard Bootstrap 5 classes. 
    -->
    <section class="container my-5" id="markerPrices">
        <th:block th:with="
            hasNewPriceHistory=${product.price.newPricehistory != null and !#lists.isEmpty(product.price.newPricehistory)},
            hasOccasionPriceHistory=${product.price.occasionPricehistory != null and !#lists.isEmpty(product.price.occasionPricehistory)}
        ">
            <div class="row text-center mb-4">
                <div class="col-12">
                    <h2 class="fw-bold">Une bonne affaire&nbsp;?</h2>
                </div>
            </div>

            <!-- If we have charts, show them first -->
            <div th:if="${hasNewPriceHistory or hasOccasionPriceHistory}" class="row">
                <div class="col-12 mb-4">
                    <div class="card shadow border-secondary">
                        <div class="card-body">
                            <div class="row">
                                <!-- New Price Chart (50%) -->
                                <div class="col-md-6" th:if="${hasNewPriceHistory}">
                                    <h3 class="h6">Historique Prix Neuf</h3>
                                    <canvas class="mt-2" id="newPriceChart" aria-label="Historique prix neuf"></canvas>
                                    <div class="text-center mt-3">
                                        <div class="btn-group" role="group" aria-label="P√©riode prix neuf">
                                            <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-15days">15j</button>
                                            <button type="button" class="btn btn-secondary active period-btn" id="btn-new-3months">3m</button>
                                            <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-6months">6m</button>
                                            <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-max">Max</button>
                                        </div>
                                    </div>
                                </div>
                                <!-- Used Price Chart (50%) -->
                                <div class="col-md-6" th:if="${hasOccasionPriceHistory}">
                                    <h3 class="h6">Historique Prix Occasion</h3>
                                    <canvas class="mt-2" id="usedPriceChart" aria-label="Historique prix occasion"></canvas>
                                    <div class="text-center mt-3">
                                        <div class="btn-group" role="group" aria-label="P√©riode prix occasion">
                                            <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-15days">15j</button>
                                            <button type="button" class="btn btn-secondary active period-btn" id="btn-used-3months">3m</button>
                                            <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-6months">6m</button>
                                            <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-max">Max</button>
                                        </div>
                                    </div>
                                </div>
                            </div> <!-- end row -->
                        </div> <!-- end card-body -->
                    </div> <!-- end card -->
                </div>
            </div>

            <!-- Price messages below -->
            <div class="row">
                <div class="col-12">
                    <div class="card shadow border-secondary mb-4">
                        <div class="card-body">
                            <!-- Variation Alerts -->
                            <div class="mb-3">
                                <div th:if="${newTrend.trend == 0}" class="alert alert-info" role="alert">
                                    üò∂‚Äçüå´Ô∏è Prix stable depuis 
                                    <span th:text="${newTrend.formatedDuration()}"></span>
                                </div>
                                <div th:if="${newTrend.trend == 1}" class="alert alert-warning" role="alert">
                                    üßê Prix augment√© de 
                                    <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                    (<span th:text="${newTrend.formatedDuration()}"></span>)
                                </div>
                                <div th:if="${newTrend.trend == -1}" class="alert alert-success" role="alert">
                                    Prix baiss√© de 
                                    <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                    (<span th:text="${newTrend.formatedDuration()}"></span>)
                                </div>
                            </div>

                            <!-- Historical Info -->
                            <div class="row">
                                <div th:if="${newTrend.historicalLowestPrice != 0}" class="col-12">
                                    <span class="d-block mb-2 fw-bold">Prix le plus bas historique !</span>
                                    <p class="mb-0">Jamais relev√© de prix aussi bas pour 
                                       <span th:text="${product.brandAndModel()}"></span>.</p>
                                </div>

                                <div th:unless="${newTrend.historicalLowestPrice != 0}" class="col-md-8">
                                    <h3 class="h6 mb-2">√âcart de prix historique</h3>
                                    <p class="mb-0">
                                        Comparaison avec le prix minimal relev√© 
                                        (<span th:text="${newTrend.historicalLowestPrice}"></span>‚Ç¨).
                                    </p>
                                </div>
                                <div th:unless="${newTrend.historicalLowestPrice != 0}" class="col-md-4 text-end">
                                    <span class="d-block my-2">
                                        <span class="h4 fw-bold" 
                                              th:text="${#numbers.formatDecimal(newTrend.historicalVariation ?: 0, 0, 1)}"></span>‚Ç¨
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="card-footer text-center">
                            <a href="#markerEcoscore" class="btn btn-primary w-100" aria-label="Meilleur prix">Meilleur prix</a>
                        </div>
                    </div>
                </div>
            </div>
        </th:block>
    </section>
</th:block>


<th:block th:fragment="product-price-variation-3">
    <!-- 
        th:comment
        This variation arranges everything side-by-side in a single row. 
        We add a subtle background on the left side. 
        Uses standard Bootstrap 5 classes. 
    -->
    <section class="container-fluid my-5" id="markerPrices">
        <th:block th:with="
            hasNewPriceHistory=${product.price.newPricehistory != null and !#lists.isEmpty(product.price.newPricehistory)},
            hasOccasionPriceHistory=${product.price.occasionPricehistory != null and !#lists.isEmpty(product.price.occasionPricehistory)}
        ">
            <div class="row">
                <!-- Left side (messages) with a background -->
                <div class="col-md-4 bg-light p-4">
                    <h2 class="fw-bold mb-4">Une bonne affaire&nbsp;?</h2>
                    <!-- Trend Alerts -->
                    <div th:if="${newTrend.trend == 0}" class="alert alert-info" role="alert">
                        Prix stable depuis 
                        <span th:text="${newTrend.formatedDuration()}"></span>
                    </div>
                    <div th:if="${newTrend.trend == 1}" class="alert alert-warning" role="alert">
                        Prix augment√© de 
                        <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                        (<span th:text="${newTrend.formatedDuration()}"></span>)
                    </div>
                    <div th:if="${newTrend.trend == -1}" class="alert alert-success" role="alert">
                        Prix baiss√© de 
                        <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                        (<span th:text="${newTrend.formatedDuration()}"></span>)
                    </div>

                    <!-- Historical Info Card -->
                    <div class="card shadow border-secondary mt-4">
                        <div class="card-body">
                            <div th:if="${newTrend.historicalLowestPrice != 0}">
                                <span class="d-block mb-2 fw-bold">
                                    Prix le plus bas historique !
                                </span>
                                <p class="mb-0">Jamais vu aussi bas pour 
                                   <span th:text="${product.brandAndModel()}"></span>.
                                </p>
                            </div>
                            <div th:unless="${newTrend.historicalLowestPrice != 0}">
                                <h5 class="mb-3">√âcart de prix historique</h5>
                                <p class="mb-0">
                                    Diff√©rence avec 
                                    <span th:text="${newTrend.historicalLowestPrice}"></span>‚Ç¨ (le plus bas relev√©).
                                </p>
                                <span class="d-block my-3 fw-bold h5"
                                      th:text="${#numbers.formatDecimal(newTrend.historicalVariation ?: 0, 0, 1)}"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Button -->
                    <div class="mt-4">
                        <a href="#markerEcoscore" class="btn btn-primary w-100" aria-label="Meilleur prix">Meilleur prix</a>
                    </div>
                </div>

                <!-- Right side (charts) -->
                <div class="col-md-8 p-4">
                    <div th:if="${hasNewPriceHistory or hasOccasionPriceHistory}">
                        <div class="row g-3">
                            <!-- New Price Chart -->
                            <div class="col-md-6" th:if="${hasNewPriceHistory}">
                                <div class="card border-secondary shadow">
                                    <div class="card-header">
                                        <h5 class="mb-0">Prix Neuf</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="newPriceChart" aria-label="Graphique prix neuf"></canvas>
                                    </div>
                                    <div class="card-footer text-center">
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-outline-secondary period-btn" id="btn-new-15days">15j</button>
                                            <button class="btn btn-secondary active period-btn" id="btn-new-3months">3m</button>
                                            <button class="btn btn-outline-secondary period-btn" id="btn-new-6months">6m</button>
                                            <button class="btn btn-outline-secondary period-btn" id="btn-new-max">Max</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Used Price Chart -->
                            <div class="col-md-6" th:if="${hasOccasionPriceHistory}">
                                <div class="card border-secondary shadow">
                                    <div class="card-header">
                                        <h5 class="mb-0">Prix Occasion</h5>
                                    </div>
                                    <div class="card-body">
                                        <canvas id="usedPriceChart" aria-label="Graphique prix occasion"></canvas>
                                    </div>
                                    <div class="card-footer text-center">
                                        <div class="btn-group" role="group">
                                            <button class="btn btn-outline-secondary period-btn" id="btn-used-15days">15j</button>
                                            <button class="btn btn-secondary active period-btn" id="btn-used-3months">3m</button>
                                            <button class="btn btn-outline-secondary period-btn" id="btn-used-6months">6m</button>
                                            <button class="btn btn-outline-secondary period-btn" id="btn-used-max">Max</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- end row -->
                    </div>
                    <div th:unless="${hasNewPriceHistory or hasOccasionPriceHistory}">
                        <div class="alert alert-secondary" role="alert">
                            Aucune donn√©e de prix disponible pour l'instant.
                        </div>
                    </div>
                </div>
            </div>
        </th:block>
    </section>
</th:block>


<th:block th:fragment="product-price-variation-4">
    <!-- 
        th:comment
        Example of using Pixel Pro classes such as alert-tertiary, btn-tertiary, border-gray-300, etc.
        Layout: A simple 2-column approach with Pixel classes for styling. 
    -->
    <section class="section container" id="markerPrices">
        <th:block th:with="
            hasNewPriceHistory=${product.price.newPricehistory != null and !#lists.isEmpty(product.price.newPricehistory)},
            hasOccasionPriceHistory=${product.price.occasionPricehistory != null and !#lists.isEmpty(product.price.occasionPricehistory)},
            colSize=${hasNewPriceHistory and hasOccasionPriceHistory ? 6 : 12}
        ">
            <div class="row text-center justify-content-center mb-4">
                <div class="col-md-8">
                    <h2 class="fw-bolder display-6">Une bonne affaire ?</h2>
                </div>
            </div>

            <div class="card shadow border-gray-300 text-center">
                <div class="row align-items-center">
                    <!-- Column 1: Alerts and Info -->
                    <div th:attr="class='col-md-' + (${hasNewPriceHistory or hasOccasionPriceHistory} ? 4 : 12)">
                        <div class="m-4">
                            <!-- Trend Alerts with Pixel classes -->
                            <div th:if="${newTrend.trend == 0}" class="alert alert-info" role="alert">
                                üò∂‚Äçüå´Ô∏è Stable depuis <span th:text="${newTrend.formatedDuration()}"></span>
                            </div>
                            <div th:if="${newTrend.trend == 1}" class="alert alert-tertiary" role="alert">
                                üßê Augmentation de <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                (<span th:text="${newTrend.formatedDuration()}"></span>)
                            </div>
                            <div th:if="${newTrend.trend == -1}" class="alert alert-success" role="alert">
                                Baisse de <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                (<span th:text="${newTrend.formatedDuration()}"></span>)
                            </div>
                        </div>

                        <!-- Historical Price Card (Pixel style) -->
                        <div class="card shadow m-4 border-gray-300">
                            <div class="card-body text-center text-md-left">
                                <div class="row align-items-center">
                                    <div th:if="${newTrend.historicalLowestPrice != 0}" class="col-md-12">
                                        <span class="h6 d-block mb-3 text-primary">
                                            Prix le plus bas historique !
                                        </span>
                                        <p class="mb-0">Jamais relev√© aussi bas pour 
                                           <span th:text="${product.brandAndModel()}"></span>.
                                        </p>
                                    </div>
                                    <div th:unless="${newTrend.historicalLowestPrice != 0}" class="col-md-8">
                                        <h2 class="h5 card-title mt-2">√âcart de prix historique</h2>
                                        <p>Comparaison avec le prix le plus bas relev√© par Nudger.</p>
                                    </div>
                                    <div th:unless="${newTrend.historicalLowestPrice != 0}" class="col-md-4 text-md-right">
                                        <span class="d-block display-6 text-info" 
                                              th:text="${#numbers.formatDecimal(newTrend.historicalVariation ?: 0, 0, 1)}">0</span>
                                        <span class="small text-muted">‚Ç¨</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Button to Ecoscore -->
                        <div class="m-4">
                            <a href="#markerEcoscore" class="btn btn-tertiary w-100">
                                <span class="me-1"><span class="fas fa-euro-sign"></span></span>
                                Meilleur prix
                            </a>
                        </div>
                    </div>

                    <!-- Column 2: Charts if present -->
                    <div class="col-md-8" th:if="${hasNewPriceHistory or hasOccasionPriceHistory}">
                        <div class="row my-4">
                            <div th:if="${hasNewPriceHistory}" th:attr="class='col-md-' + ${colSize}">
                                <canvas class="mt-4" id="newPriceChart"></canvas>
                                <div class="text-center">
                                    <div class="btn-group my-3" role="group">
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-15days">15 jours</button>
                                        <button type="button" class="btn btn-secondary active period-btn" id="btn-new-3months">3 mois</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-6months">6 mois</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-max">Max</button>
                                    </div>
                                </div>
                            </div>

                            <div th:if="${hasOccasionPriceHistory}" th:attr="class='col-md-' + ${colSize}">
                                <canvas class="mt-4" id="usedPriceChart"></canvas>
                                <div class="text-center">
                                    <div class="btn-group my-3" role="group">
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-15days">15 jours</button>
                                        <button type="button" class="btn btn-secondary active period-btn" id="btn-used-3months">3 mois</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-6months">6 mois</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-max">Max</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </th:block>
    </section>
</th:block>


<th:block th:fragment="product-price-variation-5">
    <!-- 
        th:comment
        A more "split" layout using Pixel classes. 
        We place the chart in a "bg-secondary" half, and the messages in a white half. 
    -->
    <section class="section" id="markerPrices">
        <th:block th:with="
            hasNewPriceHistory=${product.price.newPricehistory != null and !#lists.isEmpty(product.price.newPricehistory)},
            hasOccasionPriceHistory=${product.price.occasionPricehistory != null and !#lists.isEmpty(product.price.occasionPricehistory)}
        ">
            <div class="container-fluid">
                <div class="row">
                    <!-- Left side: Chart(s) with a colored background -->
                    <div class="col-md-6 bg-secondary text-white p-5" th:if="${hasNewPriceHistory or hasOccasionPriceHistory}">
                        <h2 class="h4 mb-4">Historique des prix</h2>
                        <div class="row">
                            <!-- New Price Chart -->
                            <div class="col-12 mb-4" th:if="${hasNewPriceHistory}">
                                <div class="card border-0 shadow-sm mb-4">
                                    <div class="card-body bg-white">
                                        <h3 class="h6 text-secondary">Prix Neuf</h3>
                                        <canvas id="newPriceChart" aria-label="Graphique prix neuf"></canvas>
                                    </div>
                                    <div class="card-footer text-center bg-white">
                                        <div class="btn-group">
                                            <button type="button" class="btn btn-sm btn-tertiary period-btn" id="btn-new-15days">15j</button>
                                            <button type="button" class="btn btn-sm btn-tertiary active period-btn" id="btn-new-3months">3m</button>
                                            <button type="button" class="btn btn-sm btn-tertiary period-btn" id="btn-new-6months">6m</button>
                                            <button type="button" class="btn btn-sm btn-tertiary period-btn" id="btn-new-max">Max</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Used Price Chart -->
                            <div class="col-12" th:if="${hasOccasionPriceHistory}">
                                <div class="card border-0 shadow-sm">
                                    <div class="card-body bg-white">
                                        <h3 class="h6 text-secondary">Prix Occasion</h3>
                                        <canvas id="usedPriceChart" aria-label="Graphique prix occasion"></canvas>
                                    </div>
                                    <div class="card-footer text-center bg-white">
                                        <div class="btn-group">
                                            <button type="button" class="btn btn-sm btn-tertiary period-btn" id="btn-used-15days">15j</button>
                                            <button type="button" class="btn btn-sm btn-tertiary active period-btn" id="btn-used-3months">3m</button>
                                            <button type="button" class="btn btn-sm btn-tertiary period-btn" id="btn-used-6months">6m</button>
                                            <button type="button" class="btn btn-sm btn-tertiary period-btn" id="btn-used-max">Max</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right side: Price messages -->
                    <div class="col-md-6 p-5">
                        <h2 class="fw-bold display-6 mb-4 text-dark">Une bonne affaire&nbsp;?</h2>

                        <div class="mb-4">
                            <!-- Pixel style alerts -->
                            <div th:if="${newTrend.trend == 0}" class="alert alert-info" role="alert">
                                Prix stable depuis <span th:text="${newTrend.formatedDuration()}"></span>
                            </div>
                            <div th:if="${newTrend.trend == 1}" class="alert alert-tertiary" role="alert">
                                Augmentation de <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                (<span th:text="${newTrend.formatedDuration()}"></span>)
                            </div>
                            <div th:if="${newTrend.trend == -1}" class="alert alert-success" role="alert">
                                Baisse de <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                (<span th:text="${newTrend.formatedDuration()}"></span>)
                            </div>
                        </div>

                        <div class="card shadow border-gray-300 mb-4">
                            <div class="card-body">
                                <div th:if="${newTrend.historicalLowestPrice != 0}">
                                    <span class="badge bg-info text-white">Prix Historique</span>
                                    <p class="mt-3 mb-0">Jamais relev√© de prix aussi bas pour 
                                       <span th:text="${product.brandAndModel()}"></span>.
                                    </p>
                                </div>
                                <div th:unless="${newTrend.historicalLowestPrice != 0}">
                                    <h5 class="card-title">√âcart de prix historique</h5>
                                    <p class="mb-0">Comparaison avec 
                                       <span th:text="${newTrend.historicalLowestPrice}"></span>‚Ç¨ (le plus bas).
                                    </p>
                                    <span class="d-block display-6 mt-3 text-tertiary"
                                          th:text="${#numbers.formatDecimal(newTrend.historicalVariation ?: 0, 0, 1)}">0</span>
                                </div>
                            </div>
                        </div>

                        <div>
                            <a href="#markerEcoscore" class="btn btn-primary w-100" aria-label="Meilleur prix">Meilleur prix</a>
                        </div>
                    </div>
                </div>
            </div>
        </th:block>
    </section>
</th:block>


<th:block th:fragment="product-price-variation-6">
    <!-- 
        th:comment
        A "tabbed" approach using Pixel classes, 
        where we place the New/Used price charts in tabs, 
        and the messages below. 
    -->
    <section class="section" id="markerPrices">
        <th:block th:with="
            hasNewPriceHistory=${product.price.newPricehistory != null and !#lists.isEmpty(product.price.newPricehistory)},
            hasOccasionPriceHistory=${product.price.occasionPricehistory != null and !#lists.isEmpty(product.price.occasionPricehistory)}
        ">
            <div class="container">
                <div class="row text-center mb-4">
                    <div class="col-12">
                        <h2 class="fw-bolder display-6">cwwxcre ?</h2>
                    </div>
                </div>

                <!-- Tabs for new/used charts -->
                <div class="card shadow border-gray-300">
                    <div class="card-body">
                        <ul class="nav nav-pills nav-fill flex-column flex-sm-row" id="priceTabs" role="tablist" th:if="${hasNewPriceHistory or hasOccasionPriceHistory}">
                            <li class="nav-item" th:if="${hasNewPriceHistory}">
                                <a class="nav-link active" id="new-price-tab" data-bs-toggle="tab" href="#new-price-panel"
                                   role="tab" aria-controls="new-price-panel" aria-selected="true">
                                   Prix Neuf
                                </a>
                            </li>
                            <li class="nav-item" th:if="${hasOccasionPriceHistory}">
                                <a class="nav-link" id="used-price-tab" data-bs-toggle="tab" href="#used-price-panel"
                                   role="tab" aria-controls="used-price-panel" aria-selected="false">
                                   Prix Occasion
                                </a>
                            </li>
                        </ul>

                        <div class="tab-content mt-3" id="priceTabsContent" th:if="${hasNewPriceHistory or hasOccasionPriceHistory}">
                            <!-- New Price Chart Tab -->
                            <div class="tab-pane fade show active" id="new-price-panel" role="tabpanel"
                                 aria-labelledby="new-price-tab" th:if="${hasNewPriceHistory}">
                                <canvas id="newPriceChart" aria-label="Historique prix neuf"></canvas>
                                <div class="text-center mt-3">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-15days">15j</button>
                                        <button type="button" class="btn btn-secondary active period-btn" id="btn-new-3months">3m</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-6months">6m</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-new-max">Max</button>
                                    </div>
                                </div>
                            </div>
                            <!-- Used Price Chart Tab -->
                            <div class="tab-pane fade" id="used-price-panel" role="tabpanel"
                                 aria-labelledby="used-price-tab" th:if="${hasOccasionPriceHistory}">
                                <canvas id="usedPriceChart" aria-label="Historique prix occasion"></canvas>
                                <div class="text-center mt-3">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-15days">15j</button>
                                        <button type="button" class="btn btn-secondary active period-btn" id="btn-used-3months">3m</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-6months">6m</button>
                                        <button type="button" class="btn btn-outline-secondary period-btn" id="btn-used-max">Max</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div th:unless="${hasNewPriceHistory or hasOccasionPriceHistory}" class="text-center">
                            <p class="text-muted">Aucune donn√©e de prix disponible</p>
                        </div>
                    </div>
                </div>

                <!-- Messages card -->
                <div class="card shadow border-gray-300 mt-4">
                    <div class="card-body">
                        <!-- Alerts -->
                        <div class="mb-3">
                            <div th:if="${newTrend.trend == 0}" class="alert alert-info" role="alert">
                                üò∂‚Äçüå´Ô∏è Stable depuis 
                                <span th:text="${newTrend.formatedDuration()}"></span>
                            </div>
                            <div th:if="${newTrend.trend == 1}" class="alert alert-tertiary" role="alert">
                                üßê Augmentation de 
                                <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                (<span th:text="${newTrend.formatedDuration()}"></span>)
                            </div>
                            <div th:if="${newTrend.trend == -1}" class="alert alert-success" role="alert">
                                Baisse de 
                                <b><span th:text="${#numbers.formatDecimal(newTrend.variation ?: 0, 0, 0)}"></span>‚Ç¨</b>
                                (<span th:text="${newTrend.formatedDuration()}"></span>)
                            </div>
                        </div>
                        <!-- Historical Info -->
                        <div class="row align-items-center">
                            <div th:if="${newTrend.historicalLowestPrice != 0}" class="col-12 mb-3">
                                <span class="text-primary fw-bold">Prix le plus bas historique !</span>
                                <p class="mb-0">Jamais relev√© aussi bas pour 
                                   <span th:text="${product.brandAndModel()}"></span>.
                                </p>
                            </div>
                            <div th:unless="${newTrend.historicalLowestPrice != 0}" class="col-md-8">
                                <h4 class="mb-2">√âcart de prix historique</h4>
                                <p class="mb-0">Comparaison avec le prix minimal relev√© par Nudger.</p>
                            </div>
                            <div th:unless="${newTrend.historicalLowestPrice != 0}" class="col-md-4 text-end">
                                <span class="d-block display-6 text-tertiary"
                                      th:text="${#numbers.formatDecimal(newTrend.historicalVariation ?: 0, 0, 1)}">0</span>
                                <span class="small">‚Ç¨</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer text-center">
                        <a href="#markerEcoscore" class="btn btn-primary w-100" aria-label="Meilleur prix">Meilleur prix</a>
                    </div>
                </div>
            </div>
        </th:block>
    </section>
</th:block>








