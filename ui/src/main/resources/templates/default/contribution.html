<!DOCTYPE html>
<html th:lang="${siteLocale.language}">
<head>
<!--/* 
        Insert the meta tags and CSS from inc/header-meta.html.
        This block already sets charset and viewport. 
    */-->
<th:block th:insert="~{inc/header-meta.html}"></th:block>

<!-- Primary Meta Tags -->
<title>La contribution écologique | Nudger</title>
<meta name="description" content="Nudger vous présente le principe de la contribution écologique (ou environnementale), et vous explique tout en détail !">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" th:content="${url}">
<meta property="og:title" th:content="#{compensation.title}">
<meta property="og:description" th:content="#{compensation.meta.description}">
<meta property="og:image" th:content="${baseUrl} + 'assets/img/brand/light.svg'">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url" th:content="${url}">
<meta name="twitter:title" th:content="#{compensation.title}">
<meta name="twitter:description" th:content="#{compensation.meta.description}">
<meta name="twitter:image" th:content="${baseUrl} + 'assets/img/brand/light.svg'">
</head>

<body class="contribution">
    <header>
        <!--/* Loader */-->
        <th:block th:insert="~{inc/preloader.html}"></th:block>
        <!--/* Navbar */-->
        <th:block th:insert="~{inc/navbar/navbar-home.html}"></th:block>
    </header>
	<main>
		<!--div class="mt-2" th:with="page='contribution'" th:insert="~{inc/breadcrumb-1level.html}"></div-->
		<!--/* Hero Section */-->
		<section class="section-header overflow-hidden pt-7 pt-lg-8 pb-7 bg-primary" role="region" aria-labelledby="hero-section-title">
			<div class="container">
				<div class="row justify-content-between align-items-center text-white text-center">
					<h1 id="hero-section-title" class="display-2 mb-4">La contribution écologique</h1>
					<div class="lead fw-normal text-muted mb-4 px-lg-10">
						<th:block th:with="path='pages/contribution/hero/'">
							<th:block th:insert="~{inc/wiki.html}"></th:block>
						</th:block>
					</div>
				</div>
			</div>
			<figure class="position-absolute bottom-0 left-0 w-100 d-none d-md-block mb-n2">
				<svg class="fill-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3000 185.4">
                <path d="M3000,0v185.4H0V0c496.4,115.6,996.4,173.4,1500,173.4S2503.6,115.6,3000,0z"></path>
            </svg>
			</figure>
		</section>

		<!--/* Contribution Section */-->
		<section class="section section-md" role="region" aria-labelledby="contribution-section">
			<div class="container">
				<div class="row d-flex flex-wrap align-items-center">
					<div class="col-lg-5">
						<!-- Use lazy loading for performance improvement -->
						<img class="organic-radius img-fluid" src="/img/compensation-ecologique-top.jpg" alt="Compensation carbone" loading="lazy">
					</div>
					<div class="col-lg-7">
						<blockquote class="blockquote text-center">
							<th:block th:with="path='pages/contribution/baseline',plaintext=true">
								<th:block th:insert="~{inc/wiki.html}"></th:block>
							</th:block>
						</blockquote>

						<th:block th:with="path='pages/contribution/compensation-2/'">
							<th:block th:insert="~{inc/wiki.html}"></th:block>
						</th:block>
					</div>
				</div>
			</div>
		</section>

		<!--/* Nudger Numbers Section */-->
		<section class="text-center py-4" role="region" aria-labelledby="nudger-numbers-title">
			<h2 class="h1 mb-3">L'action de Nudger en chiffres</h2>
			<p class="lead mb-0">Ce n'est qu'un début !</p>
			
			<section class="container text-center py-4">
				<div class="row justify-content-center">
					<div class="col-12 col-md-6 col-lg-4 py-3">
						<div class="icon icon-shape icon-lg bg-white shadow-lg border-light rounded-circle mb-4">
							<span class="fas fa-user text-tertiary" aria-hidden="true"></span>
						</div>
						<span class="counter display-3 fw-bolder d-block my-4" th:text="${config.reversementConfig.getDistingReversementsOrganisation()}"></span>
						<span class="text-gray">Organismes</span>
					</div>
					<div class="col-12 col-md-6 col-lg-4 py-3">
						<div class="icon icon-shape icon-lg bg-white shadow-lg border-light rounded-circle mb-4">
							<span class="fas fa-money-check text-tertiary" aria-hidden="true"></span>
						</div>
						<span class="counter display-3 fw-bolder d-block my-4">2</span>
						<span class="text-gray">Versements effectués</span>
					</div>
					<div class="col-12 col-md-6 col-lg-4 py-3">
						<div class="icon icon-shape icon-lg bg-white shadow-lg border-light rounded-circle mb-4">
							<span class="fas fa-euro-sign text-tertiary" aria-hidden="true"></span>
						</div>
						<span class="counter display-3 fw-bolder d-block my-4" th:text="${config.reversementConfig.getTotalReversements()}"></span>
						<span class="text-gray">Montant reversé</span>
					</div>		
				</div>
			</section>

		<!--/* Vote Section */-->
		<section class="section section-lg bg-primary">
            <div class="container">
				<div class="row justify-content-center mb-4 mb-lg-6 text-white">
					<div class="col-12 col-lg-9 text-center">
                		<h2 class="display-3 fw-light mb-4">Vous décidez !</h2>
						<p class="lead">Système de vote de Nudger</p>
            		</div>
				</div>

				<div class="row">
					<!-- Step 1 -->
					<div class="col-12 col-lg-6 col-xl-4 mb-5">
						<div class="card border-gray-300 rounded-md mb-3 px-2">
							<div class="card-header bg-white border-gray-300 p-4">
								<div class="text-center mb-3">
									<span class="price display-2 mb-0 text-primary">1</span>
								</div>
								<h3 class="h4 mb-3 text-black">Vous choisissez l'organisation</h3>
								<p class="fw-normal font-small mb-0">
									<th:block th:with="path='pages/contribution/vote-1'">
										<th:block th:insert="~{inc/wiki.html}"></th:block>
									</th:block>
								</p>
							</div>
						</div>
					</div>
					<!-- Step 2 -->
					<div class="col-12 col-lg-6 col-xl-4 mb-5">
						<div class="card border-gray-300 rounded-md mb-3 px-2">
							<div class="card-header bg-white border-gray-300 p-4">
								<div class="text-center mb-3">
									<span class="price display-2 mb-0 text-primary">2</span>
								</div>
								<h3 class="h4 mb-3 text-black">Fonctionnement du vote</h3>
								<p class="fw-normal font-small mb-0">
									<th:block th:with="path='pages/contribution/vote-2'">
										<th:block th:insert="~{inc/wiki.html}"></th:block>
									</th:block>
								</p>
							</div>
						</div>
					</div>
					<!-- Step 3 -->
					<div class="col-12 col-lg-6 col-xl-4 mb-5">
						<div class="card border-gray-300 rounded-md mb-3 px-2">
							<div class="card-header bg-white border-gray-300 p-4">
								<div class="text-center mb-3">
									<span class="price display-2 mb-0 text-primary">3</span>
								</div>
								<h3 class="h4 mb-3 text-black">Répartition des revenus</h3>
								<p class="fw-normal font-small mb-0">
									<th:block th:with="path='pages/contribution/vote-3'">
										<th:block th:insert="~{inc/wiki.html}"></th:block>
									</th:block>
								</p>
							</div>
						</div>
					</div>
				</div>
        </section>

		<section class="section-header bg-primary text-white pb-9 pb-lg-12 mb-4 mb-lg-6">
			<div class="container">
				<div class="row justify-content-center">
					<div class="col-12 col-md-8 text-center">
						<div class="display-2 mb-3">En toute transparence</div>
					</div>
				</div>
			</div>
		</section>
		<section class="section section-lg pt-0">
			<div class="container mt-n8 mt-lg-n12 z-2">
				<div class="row justify-content-center">
					<div class="col">
						<div class="card shadow border-gray-300 p-4 p-lg-5">
							<p class="lead">
								<th:block th:with="path='pages/contribution/vote-4'">
									<th:block th:insert="~{inc/wiki.html}"></th:block>
								</th:block>
							</p>

							<h2 class="h3 mb-4">Votes</h2>
							<p class="display-2 mb-3" th:text="${votes}"></p>
							<p class="lead">Depuis le dernier reversement</p>

							<div class="card shadow-0 border-0">
								<div class="row g-0 align-items-center">
									<div class="col-md-5">
										<h3 class="h5 card-title mb-0" th:unless="${duplicateVotes} == 0">
											<b><span th:text="${duplicateVotes}"></span></b> votes en double, exclus des données ci-dessus
										</h3>
									</div>
									<div class="col-md-7">
										<div class="card-body d-flex align-items-center">
											<canvas id="voteChart" aria-label="Chart showing the distribution of votes"></canvas>
										</div>
									</div>
								</div>
							</div>

							<h2 class="h3 mb-4" role="region" aria-labelledby="donation-details-title">Détails des dons</h2>
							

							<div class="row">
								<div class="col-lg-6">
									<p class="lead">Choix des organisations</p>
									<div class="pb-4 mb-4" th:each="org : ${config.reversementConfig.contributedOrganisations.values()}">
										<h1 class="display-1 font-weight-extreme mb-4 col-6 col-lg-4 mx-auto">
											<img class="img-thumbnail" th:src="${org.img}" th:alt="${org.name}" loading="lazy">
										</h1>
										<p class="mb-4 mb-lg-5 me-lg-5 text-start" th:text="${org.description}"></p>
										<a class="btn btn-tertiary" th:href="${org.url}">
											Se rendre sur le site 
											<span class="fas fa-angle-right ms-2"></span>
										</a>
									</div>
								</div>
								<div class="col-lg-6">
									<p class="lead">Dons effectués</p>
									<div th:each="reversement : ${config.reversementConfig.reversements}" class="border-bottom p-3">
										<div th:with="org = ${config.reversementConfig.contributedOrganisations.get(reversement.orgKey)}" class="row align-items-center justify-content-start">
											<div class="col-md-3">
												<img th:src="${org.img}" th:alt="${org.name}" loading="lazy">
											</div>
											<div class="col-md-5">
												<span class="h5 mb-3"> <span th:text="${reversement.amount}"></span> €
												</span>
											</div>
											<div class="col-md-4">
												<span class="badge bg-primary" th:text="${reversement.date}"></span>
											</div>
										</div>
									</div>

									<div class="alert alert-warning p-4 my-3 mb-5 my-lg-5 text-start" role="alert">
										<div class="media">
											<span class="mt-1 me-3"><i class="fas fa-file-alt"></i></span>
											<div class="media-body">
												<strong>Que ça depuis 2021&nbsp;???</strong> Vous êtes vigilants, et vous faîtes bien&nbsp;! L'aventure Nudger était initialement un projet "geek" annexe... Mais tel le Phénix, Nudger revient en 2024 avec l'ambition de passer à l'échelle&nbsp;!
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="mt-5 pt-5 border-top border-1" role="region" aria-labelledby="contribution-details-title">
								<h2 class="h3 mb-4 text-start">La contribution écologique en détail</h2>
								<div class="lead text-start">
									<th:block th:with="path='pages/contribution/differences-carbone/'">
										<th:block th:insert="~{inc/wiki.html}"></th:block>
									</th:block>
								</div>
								<h2 class="h3 my-4 text-start">Comment sont calculés les dons ?</h2>
								<div class="lead text-start">
									<th:block th:with="path='pages/contribution/calcul/'">
										<th:block th:insert="~{inc/wiki.html}"></th:block>
									</th:block>
								</div>
								<h2 class="h3 my-4 text-start">Puis-je vérifier ?</h2>
								<div class="lead text-start">
									<th:block th:with="path='pages/contribution/check-opensource'">
										<th:block th:insert="~{inc/wiki.html}"></th:block>
									</th:block>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
	</main>

	<!--/* Footer */-->
	<th:block th:insert="~{inc/footer.html}"></th:block>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>    
    <script defer src="/vendor/countUp.umd.js"></script>

	<!-- Setting up variables -->
	<script th:inline="javascript">
		/*<![CDATA[*/
		const repartition = /*[[${repartition}]]*/{};
		/*]]>*/
	</script>



	<!-- Vote Chart -->
	<script>
		$(document).ready(
				function() {
					const labels = Object.keys(repartition);
					const dataValues = Object.values(repartition);

					const data = {
						labels : labels,
						datasets : [ {
							label : 'Votes',
							data : dataValues,
							backgroundColor : [ 'rgba(255, 99, 132, 0.2)',
									'rgba(255, 159, 64, 0.2)',
									'rgba(255, 205, 86, 0.2)',
									'rgba(75, 192, 192, 0.2)',
									'rgba(54, 162, 235, 0.2)',
									'rgba(153, 102, 255, 0.2)',
									'rgba(201, 203, 207, 0.2)' ],
							borderColor : [ 'rgba(255, 99, 132, 1)',
									'rgba(255, 159, 64, 1)',
									'rgba(255, 205, 86, 1)',
									'rgba(75, 192, 192, 1)',
									'rgba(54, 162, 235, 1)',
									'rgba(153, 102, 255, 1)',
									'rgba(201, 203, 207, 1)' ],
							borderWidth : 1
						} ]
					};

					const ctx = document.getElementById('voteChart')
							.getContext('2d');
					var pieChart = new Chart(ctx, {
						type : 'pie',
						data : data,
						options : {
							responsive : true,
							plugins : {
								legend : {
									position : 'top',
								},
								title : {
									display : true,
									text : 'Répartition des votes'
								}
							}
						}
					});
				});
	</script>
</body>
</html>
